{
  "hash": "cf732b509372eb8d847b8285a85dfa62",
  "result": {
    "markdown": "---\ntitle: \"Home Page\"\n---\n\n\n# メッシとクリロナのクラブゴールデータ分析の研究\n\n## 研究目的\n\nメッシとロナウドのゴールを決めやすい時間、誰からのアシストが多いか、どういう決め方が多いかなどのデータから2人の得意なプレーや敵チームとの相性や特徴を調べること\n\n## 研究期間\n\n2025年4月1日~2025年7月4日\n\n## 研究内容\n\n* ゴールを決めた時間のヒストグラムと回帰分析\n\n* データ全体の決定木\n\n* アシストした人との主成分分析\n\n* ホームとアウェイの時のゴールのロジスティック回帰分析\n\n* 年毎のゴールの時系列分析\n\n## \n\n## データ\n\n### メッシとロナウドのクラブゴールデータ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DT)\ndata <- read.csv(\"./data/data.csv\", stringsAsFactors = TRUE)\ndatatable(head(data,5),options = list(autoWidth = TRUE))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-58b78f90553b5b3134cc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-58b78f90553b5b3134cc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],[\"Cristiano Ronaldo\",\"Cristiano Ronaldo\",\"Cristiano Ronaldo\",\"Cristiano Ronaldo\",\"Cristiano Ronaldo\"],[\"2/3\",\"2/3\",\"2/3\",\"2/3\",\"2/3\"],[\"Liga Portugal\",\"Liga Portugal\",\"Liga Portugal\",\"Taca de Portugal Placard\",\"Taca de Portugal Placard\"],[\"6\",\"6\",\"8\",\"Fourth Round\",\"Fifth Round\"],[\"2002/10/7\",\"2002/10/7\",\"2002/10/26\",\"2002/11/24\",\"2002/12/18\"],[\"H\",\"H\",\"A\",\"H\",\"H\"],[\"Sporting CP\",\"Sporting CP\",\"Sporting CP\",\"Sporting CP\",\"Sporting CP\"],[\"Moreirense FC\",\"Moreirense FC\",\"Boavista FC\",\"CD Estarreja\",\"FC Oliveira do Hospital\"],[\"3:00\",\"3:00\",\"1:02\",\"4:01\",\"8:01\"],[\"LW\",\"LW\",\"\",\"\",\"\"],[\"34\",\"90+5\",\"88\",\"67\",\"13\"],[\"2:00\",\"3:00\",\"1:02\",\"3:00\",\"3:00\"],[\"Solo run\",\"Header\",\"Right-footed shot\",\"Left-footed shot\",\"\"],[\"\",\"Rui Jorge\",\"Carlos Martins\",\"Cesar Prates\",\"\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Player<\\/th>\\n      <th>Season<\\/th>\\n      <th>Competition<\\/th>\\n      <th>Matchday<\\/th>\\n      <th>Date<\\/th>\\n      <th>Venue<\\/th>\\n      <th>Club<\\/th>\\n      <th>Opponent<\\/th>\\n      <th>Result<\\/th>\\n      <th>Playing_Position<\\/th>\\n      <th>Minute<\\/th>\\n      <th>At_score<\\/th>\\n      <th>Type<\\/th>\\n      <th>Goal_assist<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"autoWidth\":true,\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Player\",\"targets\":1},{\"name\":\"Season\",\"targets\":2},{\"name\":\"Competition\",\"targets\":3},{\"name\":\"Matchday\",\"targets\":4},{\"name\":\"Date\",\"targets\":5},{\"name\":\"Venue\",\"targets\":6},{\"name\":\"Club\",\"targets\":7},{\"name\":\"Opponent\",\"targets\":8},{\"name\":\"Result\",\"targets\":9},{\"name\":\"Playing_Position\",\"targets\":10},{\"name\":\"Minute\",\"targets\":11},{\"name\":\"At_score\",\"targets\":12},{\"name\":\"Type\",\"targets\":13},{\"name\":\"Goal_assist\",\"targets\":14}],\"order\":[],\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n![](fig/messi&cr7.png){width=100%}\n\n##\n\n## ライブラリの読み込み\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\n 次のパッケージを付け加えます: 'dplyr' \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n 以下のオブジェクトは 'package:stats' からマスクされています:\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n 以下のオブジェクトは 'package:base' からマスクされています:\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(gridExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\n 次のパッケージを付け加えます: 'gridExtra' \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n 以下のオブジェクトは 'package:dplyr' からマスクされています:\n\n    combine\n```\n:::\n:::\n\n\n##\n\n## ゴール時間(分)のヒストグラム\n\n::: {.cell}\n\n```{.r .cell-code}\n# 列名確認（例: \"Player\", \"Minute\" など）\ncolnames(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Player\"           \"Season\"           \"Competition\"      \"Matchday\"        \n [5] \"Date\"             \"Venue\"            \"Club\"             \"Opponent\"        \n [9] \"Result\"           \"Playing_Position\" \"Minute\"           \"At_score\"        \n[13] \"Type\"             \"Goal_assist\"     \n```\n:::\n\n```{.r .cell-code}\n# 数値に変換\ndata <- data %>%\n  mutate(\n    Minute = as.numeric(Minute),\n    Player = as.factor(Player)\n  )\n\n# 使用するプレイヤー名を指定（実際の名前に合わせてください）\nselected_players <- c(\"Lionel Messi\", \"Cristiano Ronaldo\")\n\n# プレイヤーをフィルター\nfiltered_data <- data %>% filter(Player %in% selected_players)\n\n# ヒストグラム作成\nggplot(filtered_data, aes(x = Minute, fill = Player)) +\n  geom_histogram(binwidth = 5, color = \"black\", alpha = 0.7) +\n  facet_wrap(~ Player, ncol = 1) +\n  labs(\n    title = \"メッシとロナウドのゴール時間ヒストグラム\",\n    x = \"ゴール時間（分）\",\n    y = \"ゴール数\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n##\n\n## 決定木\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"rpart\")\n#install.packages(\"rpart.plot\")\nlibrary(rpart)\nlibrary(rpart.plot)\n\n# 欠損値を含む行をすべて除去\ndata_no_na <- na.omit(data)\n\ntree <- rpart(Player ~ Competition + Season , data = data, method = \"class\")\n\n# 可視化\nrpart.plot(tree)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n##\n\n## 対戦相手とプレイポジションの主成分分析\n\n::: {.cell}\n\n```{.r .cell-code}\n# 欠損値除去\ndata_no_na <- na.omit(data[, c(\"Opponent\", \"Playing_Position\")])\n\n# ダミー変数化\ndata_dummy <- model.matrix(~ Opponent + Playing_Position - 1, data = data_no_na)\n\n# 主成分分析\npca <- prcomp(data_dummy, scale. = TRUE)\n\n# プロット\nautoplot <- function(pca) {\n  df <- as.data.frame(pca$x)\n  ggplot(df, aes(x = PC1, y = PC2)) +\n    geom_point() +\n    labs(title = \"PCA of Opponent and Playing_Position\")\n}\nautoplot(pca)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n##\n\n## アシスト選手とプレイポジションの主成分分析\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 欠損値除去\ndata_no_na <- na.omit(data[, c(\"Goal_assist\", \"Playing_Position\")])\n\n# ダミー変数化\ndata_dummy <- model.matrix(~ Goal_assist + Playing_Position - 1, data = data_no_na)\n\n# 主成分分析\npca <- prcomp(data_dummy, scale. = TRUE)\n\n# プロット\nautoplot <- function(pca) {\n  df <- as.data.frame(pca$x)\n  ggplot(df, aes(x = PC1, y = PC2)) +\n    geom_point() +\n    labs(title = \"PCA of Goal_assist and Playing_Position\")\n}\nautoplot(pca)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n##\n\n## ホーム・アウェイのゴール確率（ロジスティック回帰\n\n::: {.cell}\n\n```{.r .cell-code}\n# ゴールフラグを作成\ndata$Goal_flag <- ifelse(is.na(data$Type) | data$Type == \"\", 0, 1)\n\n# VenueがHまたはAのデータのみ抽出\ndata_ha <- subset(data, Venue %in% c(\"H\", \"A\"))\n\n# 必要なら欠損値除去\ndata_ha <- na.omit(data_ha)\n\n# Venueを0/1に変換\ndata_ha$Venue_num <- ifelse(data_ha$Venue == \"H\", 1, 0)\n\nggplot(data_ha, aes(x = Venue_num, y = Goal_flag)) +\n  geom_jitter(width = 0.1, height = 0.05, alpha = 0.5, color = \"gray40\") +\n  stat_smooth(method = \"glm\", method.args = list(family = \"binomial\"), se = FALSE, color = \"blue\", size = 1.2) +\n  scale_x_continuous(breaks = c(0, 1), labels = c(\"A（アウェイ）\", \"H（ホーム）\")) +\n  labs(title = \"Player別ホーム・アウェイのゴール確率（ロジスティック回帰）\",\n       x = \"Venue\", y = \"ゴール（1=成功, 0=失敗）\") +\n  facet_wrap(~ Player) +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n##\n\n## 年毎のゴール数の時系列分析\n\n::: {.cell}\n\n```{.r .cell-code}\n# 年を抽出\ndata$Year <- substr(data$Date, 1, 4)\n\n# ゴールフラグ（TypeがNAまたは空でなければ1）\ndata$Goal_flag <- ifelse(is.na(data$Type) | data$Type == \"\", 0, 1)\n\n# Player別・年別ゴール数を集計\ngoal_by_player_year <- data %>%\n  group_by(Player, Year) %>%\n  summarise(Goals = sum(Goal_flag), .groups = \"drop\")\n\n# グラフ描画\nggplot(goal_by_player_year, aes(x = as.numeric(Year), y = Goals, color = Player, group = Player)) +\n  geom_line(size = 1.2) +\n  geom_point(size = 3) +\n  labs(title = \"Player別・年毎のゴール数の時系列分析\",\n       x = \"年\",\n       y = \"ゴール数\") +\n  theme_minimal(base_size = 16)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8/fill.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/datatables-binding-0.33/datatables.js\"></script>\r\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}